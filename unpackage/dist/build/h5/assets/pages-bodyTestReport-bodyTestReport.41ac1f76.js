import{E as e,m as t,O as s,D as o,l as a,o as n,a as i,w as r,i as l,b as c,A as u,B as d,F as m,d as p,f,p as h,v as g,e as y,t as b,I as v,q as C}from"./index.2d1e5cbb.js";import{_,a as k}from"./uni-forms.5db05612.js";import{r as T}from"./uni-app.es.142f3165.js";import{B as N}from"./bgTheamCompontent.f506f940.js";import{N as O}from"./navBarCompontent.7dcad6b7.js";import{u as F}from"./timeUtil.f179a302.js";import{M as I}from"./mPicker.4fdcbc4b.js";import{_ as q}from"./back.3d645e4a.js";import{_ as j}from"./_plugin-vue_export-helper.cdc0426e.js";import"./uni-transition.c98c413f.js";var w=e.importObject("businessCloudObject",{customUI:!0});const L=j({components:{BgTheamCompontent:N,NavBarCompontent:O,Mpicker:I},data:()=>({configForm:{},pickerShow:!1,traineeNo:"",questionCode:"",originList:[],bodyTestReport:[],range:[]}),onLoad(e){if("{}"!==JSON.stringify(e)&&e.traineeNo&&(this.traineeNo=e.traineeNo),"{}"!==JSON.stringify(e)&&e.hasOwnProperty("childList")){let t=JSON.parse(e.childList);this.originList=t}"{}"!==JSON.stringify(e)&&e.hasOwnProperty("questionCode")&&(this.questionCode=e.questionCode)},mounted(){this.requestList()},computed:{handleIndex:()=>function(e){let t=0;return t=e.configList.findIndex((t=>t.value===e.defaultValue)),t},handleFormValue:()=>function(e){let t="";return e.hasOwnProperty("value")&&(t=e.value||""),{value:t}},controlType:()=>function(e){return["height","visceralfatgrade","bodyFraction"].indexOf(e.key),"ordinary"}},methods:{changeInputValue(e,s,o){e.detail.value>5e3?(t({title:"基础代谢上限5000",duration:1e3,width:180,icon:"none"}),setTimeout((()=>{s.value="5000",e.detail.value="5000"}),200)):s.value=e.detail.value},pickeConfirm(e,t,s){console.log(t,"我平时",s),t.flag=!1,t.value=t.configList[e].text||""},pickCancel(e){e.flag=!1},openDialog(e){e.flag=!0},saveBodyTestReport(){var e={};this.bodyTestReport.forEach((t=>{let s={[t.key]:t.hasOwnProperty("value")?t.value:""};console.log(s,"readyParam"),Object.assign(e,s)}));let o={traineeNo:this.traineeNo,questionCode:this.questionCode,bodyTestReport:e};w.opearConfig(o,"bodyTestReport").then((e=>{console.log(e,"我要保存了"),e.success&&(s({url:"/pages/physicalAssessment/physicalAssessment?traineeNo="+this.traineeNo+"&questionCode="+this.questionCode}),t({icon:"success",title:e.message,duration:800}))})).catch((()=>{}))},requestList(){var e=this;w.opearConfigQuery({traineeNo:this.traineeNo,questionCode:this.questionCode}).then((t=>{let s=this.originList.map((e=>{let t=[];return e.hasOwnProperty("configList")&&e.configList.length>0&&(t=e.configList),{...e,configList:t,flag:!1}}));console.log(t,"kkkkk"),0===t.affectedDocs?(this.configForm={},this.bodyTestReport=s):(s=s.map((s=>{var o=null;let a="";return t.data.forEach((t=>{for(var n in t.bodyTestReport)s.key===n&&(o={[n]:t.bodyTestReport[n]},a=t.bodyTestReport[n],Object.assign(e.configForm,o))})),{...s,flag:!1,value:a}})),console.log(e.configForm,"this.configForm",s),e.bodyTestReport=s)})).catch((e=>{}))},formatter:(e,t)=>"year"===e?`${t}年`:"month"===e?`${t}月`:"day"===e?`${t}日`:"hour"===e?`${t}时`:"minute"===e?`${t}分`:t,genderChange(e){},birthConfirm(){this.studentForm.birthday=F.timeFormat(this.currentDate,"yyyy-MM-dd"),this.dateShowpicker=!1},genderConfirm(e){this.studentForm.gender=e.value,this.gender=e.text;let t=this.columns.findIndex((t=>{t.value=e.value}));this.defaultIndex=t,this.showPicker=!1},addDirectly(s){var n=this;this.$refs.studentForm.validate().then((()=>{let i=e.importObject("businessCloudObject");console.log(n.requestItem,"that.requestItem"),"edit"==s||n.requestItem?i.updateMember(n.studentForm).then((e=>{e.success?(o({url:"/pages/myMebers/myMebers",success:e=>{},fail:()=>{},complete:()=>{}}),t({icon:"success",title:res.message,duration:800})):t({icon:"fail",title:res.message,duration:800})})).catch((e=>{t({icon:"编辑失败",title:e.message,duration:800})})):i.addMember(n.studentForm).then((e=>{e.success?(console.log(s,">>>>"),"body"==s?i.getOnlyList({traineeName:n.studentForm.traineeName,mobile:n.studentForm.mobile}).then((e=>{if(console.log(e,"即将发送的res"),e.success){let t=e.data;a({url:"/pages/physicalAssessment/physicalAssessment?traineeNo="+t[0]._id})}})).catch((e=>{})):o({url:"/pages/myMebers/myMebers",success:e=>{},fail:()=>{},complete:()=>{}}),t({icon:"success",title:e.message,duration:800})):(console.log(2),t({icon:"fail",title:e.message,duration:800}))})).catch((e=>{}))})).catch((e=>{}))},onConfirm(){},onSubmit(){},buyClick(e){this.studentForm.buyStatus=e}}},[["render",function(e,t,s,o,a,N){const O=h("BgTheamCompontent"),F=h("NavBarCompontent"),I=v,j=T(g("uni-forms-item"),_),w=h("Mpicker"),L=l,x=C,R=T(g("uni-forms"),k);return n(),i(L,{class:"content_style"},{default:r((()=>[c(O,{theamType:"currency"}),c(F,{leftNavTitle:"体测报告填写"}),c(L,{class:"contetnt_form_style"},{default:r((()=>[c(R,{modelValue:a.configForm,ref:"studentForm","label-position":"top"},{default:r((()=>[(n(!0),u(m,null,d(a.bodyTestReport,((e,t)=>(n(),u(m,{key:t},[e.isInput&&"y"===e.isInput?(n(),i(j,{key:0,class:"outer_form_item_style",label:e.questionContent,name:e.code},{default:r((()=>[c(I,{type:"number",class:"change_input_style",modelValue:e.value,"onUpdate:modelValue":t=>e.value=t,onInput:s=>N.changeInputValue(s,e,t),placeholder:e.answerRemark.remarkTitle,style:{"margin-top":"6px"},"adjust-position":!1},null,8,["modelValue","onUpdate:modelValue","onInput","placeholder"])])),_:2},1032,["label","name"])):(n(),i(j,{key:1,class:"outer_form_item_style",label:e.questionContent,name:e.code},{default:r((()=>[c(L,{class:"change_picker_style"},{default:r((()=>[c(w,{mode:"bottom",show:e.flag,range:e.configList,rangeKey:"text",onConfirm:s=>N.pickeConfirm(s,e,t),onCancel:t=>N.pickCancel(e),pickerType:N.controlType(e),defaultIndex:N.handleIndex(e)},null,8,["show","range","onConfirm","onCancel","pickerType","defaultIndex"]),c(L,{class:"change_picker_style",onClick:f((t=>N.openDialog(e)),["stop"])},{default:r((()=>[c(L,{class:y(["label_style",e.hasOwnProperty("value")&&e.value?"":"student_label_style"])},{default:r((()=>[p(b(e.hasOwnProperty("value")&&e.value?e.value:e.answerRemark.remarkTitle),1)])),_:2},1032,["class"]),c(x,{class:"back_img_style",src:q})])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1032,["label","name"]))],64)))),128))])),_:1},8,["modelValue"])])),_:1}),c(L,{class:"bottom_style",onClick:f(N.saveBodyTestReport,["stop"])},{default:r((()=>[p("保存")])),_:1},8,["onClick"])])),_:1})}],["__scopeId","data-v-e9ebe398"]]);export{L as default};
