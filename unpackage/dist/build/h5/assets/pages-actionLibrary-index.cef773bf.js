import{E as t,$ as a,a0 as e,s,a1 as i,j as l,H as o,m as n,o as c,a as d,w as u,i as r,b as m,e as h,d as p,U as C,n as f,A as y,B as v,F as g,t as x,x as L,I as k,p as N,C as _,v as b}from"./index.2d1e5cbb.js";import{_ as A}from"./uni-popup.2df5a944.js";import{r as S}from"./uni-app.es.142f3165.js";import{p as w}from"./index.7e29daec.js";import{_ as O}from"./_plugin-vue_export-helper.cdc0426e.js";import"./uni-transition.c98c413f.js";const I=t.importObject("actionLibrary",{customuI:!0});const J=O({components:{popover:w},data:()=>({mode:0,actionName:null,actionIndex:0,actionClass:0,actionClassName:"胸部",actionClassList:[{text:"胸部",value:0},{text:"背部",value:1},{text:"腿部",value:2},{text:"臀部",value:3},{text:"肩部",value:4},{text:"二头肌",value:5},{text:"三头肌",value:6},{text:"腹部",value:7},{text:"小腿",value:8},{text:"斜方肌",value:9},{text:"自定义动作",value:10}],actionClassListAll:[{text:"胸部",value:0},{text:"背部",value:1},{text:"腿部",value:2},{text:"臀部",value:3},{text:"肩部",value:4},{text:"二头肌",value:5},{text:"三头肌",value:6},{text:"腹部",value:7},{text:"小腿",value:8},{text:"斜方肌",value:9},{text:"自定义动作",value:10}],actionClassListPro:[{text:"颈前引",value:11},{text:"圆肩",value:12},{text:"驼背",value:13},{text:"骨盆前倾",value:14},{text:"骨盆后倾",value:15},{text:"膝内扣",value:16},{text:"足外翻",value:17},{text:"足内翻",value:18},{text:"翼状肩胛",value:19},{text:"自定义动作",value:20}],actions:[{text:"修改动作"},{text:"删除动作"}],showDialog:!1,showSaveButton:!1,actionList:[],selectActionList:[],actionTypeList:[{type:0,title:"力量训练",des:"力量训练的类型，可以为自定义动作提供记录次数和重量，其中重量的单位只能为公斤（kg）和磅（lbs）",active:!1},{type:1,title:"有氧训练",des:"有氧训练有多种记录形式，用户可以自行选择多种记录组合进行搭配",active:!1},{type:2,title:"仅需要填写次数",des:"有些动作既不会负重，也不需要重物，此时你可以选择这种记录方式",active:!1},{type:3,title:"仅记录时间",des:"有些动作你只想记录时间的，选择此类记录形式你可以自行选择用秒表还是计时器",active:!1},{type:4,title:"自重训练",des:"自重动作、自动负重动作，都适合这种训练类型。如果你不负重，那么你可以只填写次数；如果负重，那么可以填写附加的重量",active:!1},{type:5,title:"自重辅助",des:"例如辅助引体向上、辅助臂屈伸等等项目，需要用到辅助重量的动作，适合这种类型。这种类型可以自行设置体重。",active:!1},{type:6,title:"放松训练",des:"拉伸动作无需记录任何数据",active:!1}]}),onShow(){this.selectActionList=[];if("select"===a("actionLibraryType")){const t=a("actionList");if(t){const a=JSON.parse(t);a.forEach((t=>t.isOld=!0)),this.selectActionList=a}e(),this.showSaveButton=!0}else s(),this.showSaveButton=!1;const t=a("actionLibrary");if(t){const a=JSON.parse(t);this.mode=a.mode,this.actionIndex=a.actionIndex,this.actionClass=a.actionClass,this.actionClassName=a.actionClassName,"1"==this.mode&&this.modeChangeHandle(1,"back")}this.actionClassList.forEach((t=>{const a=this.selectActionList.filter((a=>a.actionClass===t.value));t.badge=a.length||null})),i("actionLibrary"),this.getActionList()},methods:{sidebarClick(t){this.actionClass=t.value,this.actionClassName=t.text,this.getActionList()},async getActionList(){this.actionList=[];const t=(await I.getActionList({type:this.mode,actionClass:this.actionClass,actionName:this.actionName})).data||[];t.sort((function(t,a){return t.actionId-a.actionId}));const a=t.map((t=>this.selectActionList.some((a=>t._id===a._id))?{...t,active:!0}:{...t,active:!1})),e=a.map((t=>t.actionType)),s=[...new Set(e)];this.actionList=s.map((t=>{const e=a.filter((a=>a.actionType===t));return{actionType:t,children:e}})),this.actionClassList.forEach((t=>{const a=this.selectActionList.filter((a=>a.actionClass===t.value));t.badge=a.length||null})),console.log(this.actionList,888)},modeChangeHandle(t,a){this.mode=t,"back"===a?this.actionClassList=0===t?JSON.parse(JSON.stringify(this.actionClassListAll)):JSON.parse(JSON.stringify(this.actionClassListPro)):(0===t?(this.actionIndex=0,this.actionClass=0,this.actionClassList=JSON.parse(JSON.stringify(this.actionClassListAll))):(this.actionIndex=0,this.actionClass=11,this.actionClassList=JSON.parse(JSON.stringify(this.actionClassListPro))),this.getActionList())},selectAction(t){this.showSaveButton&&(t.active=!t.active,t.active?this.selectActionList.push({...t,actionClassName:this.actionClassName}):this.selectActionList=this.selectActionList.filter((a=>a._id!==t._id)),this.actionClassList.forEach((t=>{const a=this.selectActionList.filter((a=>a.actionClass===t.value));t.badge=a.length||null})),console.log("this.selectActionList",this.selectActionList))},selectClick(t,a){"删除动作"===t.text?(this.currentAction=a,this.$refs.popup.open()):"修改动作"===t.text&&(l("actionLibrary",JSON.stringify({mode:this.mode,actionClass:this.actionClass,actionClassName:this.actionClassName,actionIndex:this.actionIndex})),o({url:`/pages/addAction/index?type=${this.mode}&actionClass=${this.actionClass}&update=1&id=${a._id}&actionName=${a.actionName}&actionType=${a.actionType}`}))},addActionHandle(t){l("actionLibrary",JSON.stringify({mode:this.mode,actionClass:this.actionClass,actionClassName:this.actionClassName,actionIndex:this.actionIndex}));if("select"===a("actionLibraryType")){const t=this.selectActionList.map((t=>t.isOld?t:{_id:t._id,type:t.actionType,actionName:t.actionName,actionClass:t.actionClass,actionClassName:t.actionClassName,url:t.url,load:0,times:0,mileage:0,frequency:0,weight:null,groupList:[{kg:null,km:null,time:null,hour:null,minute:null,second:null,active:!1}],open:!1})),e=a("actionList");if(e){const a=JSON.parse(e);a&&0!==a.length||t.forEach(((t,a)=>{t.open=!(a>0)}))}l("actionList",JSON.stringify(t))}0===this.mode&&"z"===t?(l("actionLibrary",JSON.stringify({mode:this.mode,actionClass:"10",actionClassName:"自定义动作",actionIndex:"10"})),o({url:`/pages/addAction/index?type=${this.mode}&actionClass=10`})):1===this.mode&&"z"===t?(l("actionLibrary",JSON.stringify({mode:this.mode,actionClass:"20",actionClassName:"自定义动作",actionIndex:"9"})),o({url:`/pages/addAction/index?type=${this.mode}&actionClass=20`})):o({url:`/pages/addAction/index?type=${this.mode}&actionClass=${this.actionClass}`})},async deleteHandle(){this.$refs.popup.close(),await I.deleteAction({id:this.currentAction._id}),n({title:"删除成功",duration:1e3}),this.getActionList()},closePopup(){this.$refs.popup.close()},goBack(){l("actionLibraryType","show"),o({url:"/pages/newWorkout/newWorkout"}),this.actionList=[],s()},goNewWorkout(){l("actionLibraryType","show");const t=this.selectActionList.map((t=>t.isOld?t:{_id:t._id,type:t.actionType,actionName:t.actionName,actionClass:t.actionClass,actionClassName:t.actionClassName,url:t.url,load:0,times:0,mileage:0,frequency:0,weight:null,groupList:[{kg:null,km:null,time:null,hour:null,minute:null,second:null,active:!1}],open:!1})),e=a("actionList");if(e){const a=JSON.parse(e);a&&0!==a.length||t.forEach(((t,a)=>{t.open=!(a>0)}))}l("actionList",JSON.stringify(t)),l("actionLibrary",JSON.stringify({mode:this.mode,actionClass:this.actionClass,actionClassName:this.actionClassName,actionIndex:this.actionIndex})),o({url:"/pages/newWorkout/newWorkout"}),this.actionList=[],s()}},computed:{selectNum(){return this.selectActionList.length||0},tryme(){let t=1.3;return 1===this.mode&&(t=6.125*this.mode+3),t+"rem"}}},[["render",function(t,a,e,s,i,l){const o=r,n=k,w=N("van-sidebar-item"),O=N("van-sidebar"),I=_,J=N("popover"),T=N("van-image"),$=N("van-button"),B=S(b("uni-popup"),A);return c(),d(o,{class:"action-library"},{default:u((()=>[m(o,{class:"status_bar"}),m(o,{class:"background-header"}),m(o,{class:"background"}),m(o,{class:"header"},{default:u((()=>[m(o,{class:h(["all-action",{active:0===i.mode}]),onClick:a[0]||(a[0]=t=>l.modeChangeHandle(0))},{default:u((()=>[p("全部动作库")])),_:1},8,["class"]),m(o,{class:h(["problem-action",{active:1===i.mode}]),onClick:a[1]||(a[1]=t=>l.modeChangeHandle(1))},{default:u((()=>[p("问题动作库")])),_:1},8,["class"]),m(o,{class:"custom-action",onClick:a[2]||(a[2]=t=>l.addActionHandle("z"))},{default:u((()=>[p("+ 自定义动作")])),_:1}),C("div",{class:"firstLine",style:f({left:l.tryme})},null,4)])),_:1}),m(o,{class:"search"},{default:u((()=>[m(o,{class:"uni-search"},{default:u((()=>[m(o,{class:"image"}),m(n,{class:"uni-input",modelValue:i.actionName,"onUpdate:modelValue":a[3]||(a[3]=t=>i.actionName=t),onConfirm:l.getActionList,"confirm-type":"search",placeholder:"输入动作名称搜索"},null,8,["modelValue","onConfirm"])])),_:1})])),_:1}),m(o,{class:h(["content",{"select-page":i.showSaveButton}])},{default:u((()=>[m(o,{class:"sidebar"},{default:u((()=>[m(O,{modelValue:i.actionIndex,"onUpdate:modelValue":a[4]||(a[4]=t=>i.actionIndex=t)},{default:u((()=>[i.showSaveButton?(c(!0),y(g,{key:1},v(i.actionClassList,(t=>(c(),d(w,{key:t.value,title:t.text,badge:t.badge,onClick:a=>l.sidebarClick(t)},null,8,["title","badge","onClick"])))),128)):(c(!0),y(g,{key:0},v(i.actionClassList,(t=>(c(),d(w,{key:t.value,title:t.text,onClick:a=>l.sidebarClick(t)},null,8,["title","onClick"])))),128))])),_:1},8,["modelValue"])])),_:1}),m(o,{class:"action-list"},{default:u((()=>[m(o,{class:"action-list-title"},{default:u((()=>[p(x(i.actionClassName)+"训练动作",1)])),_:1}),m(o,{class:"action-list-view"},{default:u((()=>[(c(!0),y(g,null,v(i.actionList,((t,a)=>(c(),d(o,{key:a,class:"classify-box"},{default:u((()=>[m(o,{class:"classify"},{default:u((()=>[p(x(i.actionTypeList[t.actionType].title),1)])),_:2},1024),m(o,{class:"action-list-box"},{default:u((()=>[(c(!0),y(g,null,v(t.children,(t=>(c(),y(g,{key:t._id},[t.userId?(c(),d(o,{key:0,class:h(["action-list-item",{active:t.active}]),onClick:a=>l.selectAction(t)},{default:u((()=>[m(J,{className:"image",list:i.actions,mode:"longpress",onSelctClick:a=>l.selectClick(a,t)},{item:u((({item:t})=>["删除动作"===t.text?(c(),d(I,{key:0,style:{color:"#f04242"}},{default:u((()=>[p(x(t.text),1)])),_:2},1024)):(c(),d(I,{key:1},{default:u((()=>[p(x(t.text),1)])),_:2},1024))])),default:u((()=>[m(o,{class:"action-name"},{default:u((()=>[p(x(t.actionName[0]),1)])),_:2},1024)])),_:2},1032,["list","onSelctClick"]),m(o,{class:"text"},{default:u((()=>[p(x(t.actionName),1)])),_:2},1024)])),_:2},1032,["class","onClick"])):(c(),d(o,{key:1,class:h(["action-list-item",{active:t.active}]),onClick:a=>l.selectAction(t)},{default:u((()=>[m(o,{class:"image"},{default:u((()=>[t.url?(c(),d(T,{key:0,round:"",src:t.url},null,8,["src"])):(c(),d(o,{key:1,class:"van-image"}))])),_:2},1024),m(o,{class:"text"},{default:u((()=>[p(x(t.actionName),1)])),_:2},1024)])),_:2},1032,["class","onClick"]))],64)))),128))])),_:2},1024)])),_:2},1024)))),128)),m(o,{class:"custom-action-button",onClick:l.addActionHandle},{default:u((()=>[m(I,null,{default:u((()=>[p(" + 自定义动作")])),_:1})])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1},8,["class"]),i.showSaveButton?(c(),d(o,{key:0,class:"footer-seat"})):L("",!0),i.showSaveButton?(c(),d(o,{key:1,class:"footer-button"},{default:u((()=>[m($,{type:"default",onClick:l.goBack},{default:u((()=>[p("取消")])),_:1},8,["onClick"]),m($,{block:"",type:"primary",onClick:l.goNewWorkout},{default:u((()=>[p("确认添加（"+x(l.selectNum)+"）",1)])),_:1},8,["onClick"])])),_:1})):L("",!0),m(B,{ref:"popup",type:"center","mask-background-color":"rgba(20, 21, 23, 0.6)"},{default:u((()=>[m(o,{class:"dialog"},{default:u((()=>[m(o,{class:"dialog-section"},{default:u((()=>[m(o,{class:"dialog-title"},{default:u((()=>[p("是否确认删除")])),_:1}),m(o,{class:"dialog-content"},{default:u((()=>[p("确认删除该动作吗？删除后无法恢复")])),_:1}),m(o,{class:"dialog-btn-box"},{default:u((()=>[m($,{type:"default",onClick:l.closePopup},{default:u((()=>[p("取消")])),_:1},8,["onClick"]),m($,{type:"primary",onClick:l.deleteHandle},{default:u((()=>[p("确认")])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1})])),_:1},512)])),_:1})}],["__scopeId","data-v-bc73e472"]]);export{J as default};
