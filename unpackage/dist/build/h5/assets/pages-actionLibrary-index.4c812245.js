import{E as t,Z as e,_ as a,s,H as i,m as l,l as o,o as c,a as n,w as u,i as d,b as r,e as p,d as h,A as m,B as v,F as f,t as C,p as x,I as y,q as k,C as _,v as g}from"./index.3c07bbe7.js";import{_ as L}from"./uni-popup.159bf41e.js";import{r as b}from"./uni-app.es.2e9f864b.js";import{p as A}from"./index.bce68700.js";import{_ as N}from"./_plugin-vue_export-helper.cdc0426e.js";import"./uni-transition.23e18650.js";const w=t.importObject("actionLibrary");const S=N({components:{popover:A},data:()=>({mode:0,actionName:null,actionIndex:0,actionClass:0,actionClassName:"胸",actionClassList:[{text:"胸部",value:0},{text:"背部",value:1},{text:"腿部",value:2},{text:"臀部",value:3},{text:"肩部",value:4},{text:"二头肌",value:5},{text:"三头肌",value:6},{text:"腹部",value:7},{text:"小腿",value:8},{text:"斜方肌",value:9},{text:"自定义动作",value:10}],actionClassListAll:[{text:"胸部",value:0},{text:"背部",value:1},{text:"腿部",value:2},{text:"臀部",value:3},{text:"肩部",value:4},{text:"二头肌",value:5},{text:"三头肌",value:6},{text:"腹部",value:7},{text:"小腿",value:8},{text:"斜方肌",value:9},{text:"自定义动作",value:10}],actionClassListPro:[{text:"颈前引",value:11},{text:"圆肩",value:12},{text:"驼背",value:13},{text:"骨盆前倾",value:14},{text:"骨盆后倾",value:15},{text:"膝内扣",value:16},{text:"足外翻",value:17},{text:"足内翻",value:18},{text:"翼状肩胛",value:19},{text:"自定义动作",value:20}],actions:[{text:"修改动作"},{text:"删除动作"}],showDialog:!1,showSaveButton:!1,actionList:[],selectActionList:[],actionTypeList:[{type:0,title:"力量训练",des:"力量训练的类型，可以为自定义动作提供记录次数和重量，其中重量的单位只能为公斤（kg）和磅（lbs）",active:!1},{type:1,title:"有氧训练",des:"有氧训练有多种记录形式，用户可以自行选择多种记录组合进行搭配",active:!1},{type:2,title:"仅需要填写次数",des:"有些动作既不会负重，也不需要重物，此时你可以选择这种记录方式",active:!1},{type:3,title:"仅记录时间",des:"有些动作你只想记录时间的，选择此类记录形式你可以自行选择用秒表还是计时器",active:!1},{type:4,title:"自重训练",des:"自重动作、自动负重动作，都适合这种训练类型。如果你不负重，那么你可以只填写次数；如果负重，那么可以填写附加的重量",active:!1},{type:5,title:"自重辅助",des:"例如辅助引体向上、辅助臂屈伸等等项目，需要用到辅助重量的动作，适合这种类型。这种类型可以自行设置体重。",active:!1},{type:6,title:"放松训练",des:"拉伸动作无需记录任何数据",active:!1}]}),onShow(){this.selectActionList=[];"select"===e("actionLibraryType")?(this.actionClassList.forEach((t=>{const e=this.selectActionList.filter((e=>e.actionClass===t.value));t.badge=e.length||null})),a(),this.showSaveButton=!0):(s(),this.showSaveButton=!1),this.getActionList()},methods:{sidebarClick(t){this.actionClass=t.value,this.actionClassName=t.text,this.getActionList()},async getActionList(){this.actionList=[];const t=((await w.getActionList({type:this.mode,actionClass:this.actionClass,actionName:this.actionName})).data||[]).map((t=>this.selectActionList.some((e=>t._id===e._id))?{...t,active:!0}:{...t,active:!1})),e=t.map((t=>t.actionType)),a=[...new Set(e)];this.actionList=a.map((e=>{const a=t.filter((t=>t.actionType===e));return{actionType:e,children:a}})),console.log(this.actionList,888)},modeChangeHandle(t){this.mode=t,0===t?(this.actionIndex=0,this.actionClass=0,this.actionClassList=JSON.parse(JSON.stringify(this.actionClassListAll))):(this.actionIndex=0,this.actionClass=11,this.actionClassList=JSON.parse(JSON.stringify(this.actionClassListPro))),this.getActionList()},selectAction(t){this.showSaveButton&&(t.active=!t.active,t.active?this.selectActionList.push(t):this.selectActionList=this.selectActionList.filter((e=>e._id!==t._id)),this.actionClassList.forEach((t=>{const e=this.selectActionList.filter((e=>e.actionClass===t.value));t.badge=e.length||null})))},selectClick(t,e){"删除动作"===t.text?(this.currentAction=e,this.$refs.popup.open()):"修改动作"===t.text&&i({url:`/pages/addAction/index?type=${this.mode}&actionClass=${this.actionClass}&update=1&id=${e._id}&actionName=${e.actionName}&actionType=${e.actionType}`})},addActionHandle(t){0===this.mode&&"z"===t?i({url:`/pages/addAction/index?type=${this.mode}&actionClass=10`}):1===this.mode&&"z"===t?i({url:`/pages/addAction/index?type=${this.mode}&actionClass=20`}):i({url:`/pages/addAction/index?type=${this.mode}&actionClass=${this.actionClass}`})},async deleteHandle(){this.$refs.popup.close(),await w.deleteAction({id:this.currentAction._id}),l({title:"删除成功",duration:1e3}),this.getActionList()},closePopup(){this.$refs.popup.close()},goBack(){o("actionLibraryType","show"),o("actionList",JSON.stringify([])),i({url:"/pages/newWorkout/newWorkout"}),this.actionList=[],s()},goNewWorkout(){o("actionLibraryType","show"),o("actionList",JSON.stringify(this.selectActionList)),i({url:"/pages/newWorkout/newWorkout"}),this.actionList=[],s()}},computed:{selectNum(){return this.selectActionList.length||0}}},[["render",function(t,e,a,s,i,l){const o=d,A=y,N=k("van-sidebar-item"),w=k("van-sidebar"),S=_,$=k("popover"),B=k("van-image"),T=k("van-button"),H=b(g("uni-popup"),L);return c(),n(o,{class:"action-library"},{default:u((()=>[r(o,{class:"status_bar"}),r(o,{class:"background-header"}),r(o,{class:"background"}),r(o,{class:"header"},{default:u((()=>[r(o,{class:p(["all-action",{active:0===i.mode}]),onClick:e[0]||(e[0]=t=>l.modeChangeHandle(0))},{default:u((()=>[h("全部动作库")])),_:1},8,["class"]),r(o,{class:p(["problem-action",{active:1===i.mode}]),onClick:e[1]||(e[1]=t=>l.modeChangeHandle(1))},{default:u((()=>[h("问题动作库")])),_:1},8,["class"]),r(o,{class:"custom-action",onClick:e[2]||(e[2]=t=>l.addActionHandle("z"))},{default:u((()=>[h("+ 自定义动作")])),_:1})])),_:1}),r(o,{class:"search"},{default:u((()=>[r(o,{class:"uni-search"},{default:u((()=>[r(o,{class:"image"}),r(A,{class:"uni-input",modelValue:i.actionName,"onUpdate:modelValue":e[3]||(e[3]=t=>i.actionName=t),onConfirm:l.getActionList,"confirm-type":"search",placeholder:"输入动作名称搜索"},null,8,["modelValue","onConfirm"])])),_:1})])),_:1}),r(o,{class:p(["content",{"select-page":i.showSaveButton}])},{default:u((()=>[r(o,{class:"sidebar"},{default:u((()=>[r(w,{modelValue:i.actionIndex,"onUpdate:modelValue":e[4]||(e[4]=t=>i.actionIndex=t)},{default:u((()=>[i.showSaveButton?(c(!0),m(f,{key:1},v(i.actionClassList,(t=>(c(),n(N,{key:t.value,title:t.text,badge:t.badge,onClick:e=>l.sidebarClick(t)},null,8,["title","badge","onClick"])))),128)):(c(!0),m(f,{key:0},v(i.actionClassList,(t=>(c(),n(N,{key:t.value,title:t.text,onClick:e=>l.sidebarClick(t)},null,8,["title","onClick"])))),128))])),_:1},8,["modelValue"])])),_:1}),r(o,{class:"action-list"},{default:u((()=>[r(o,{class:"action-list-title"},{default:u((()=>[h(C(i.actionClassName)+"训练动作",1)])),_:1}),r(o,{class:"action-list-view"},{default:u((()=>[(c(!0),m(f,null,v(i.actionList,((t,e)=>(c(),n(o,{key:e,class:"classify-box"},{default:u((()=>[r(o,{class:"classify"},{default:u((()=>[h(C(i.actionTypeList[t.actionType].title),1)])),_:2},1024),r(o,{class:"action-list-box"},{default:u((()=>[(c(!0),m(f,null,v(t.children,(t=>(c(),m(f,{key:t._id},[t.userId?(c(),n(o,{key:0,class:p(["action-list-item",{active:t.active}]),onClick:e=>l.selectAction(t)},{default:u((()=>[r($,{className:"image",list:i.actions,mode:"longpress",onSelctClick:e=>l.selectClick(e,t)},{item:u((({item:t})=>["删除动作"===t.text?(c(),n(S,{key:0,style:{color:"#F04242"}},{default:u((()=>[h(C(t.text),1)])),_:2},1024)):(c(),n(S,{key:1},{default:u((()=>[h(C(t.text),1)])),_:2},1024))])),default:u((()=>[r(o,{class:"action-name"},{default:u((()=>[h(C(t.actionName[0]),1)])),_:2},1024)])),_:2},1032,["list","onSelctClick"]),r(o,{class:"text"},{default:u((()=>[h(C(t.actionName),1)])),_:2},1024)])),_:2},1032,["class","onClick"])):(c(),n(o,{key:1,class:p(["action-list-item",{active:t.active}]),onClick:e=>l.selectAction(t)},{default:u((()=>[r(o,{class:"image"},{default:u((()=>[t.url?(c(),n(B,{key:0,round:"",src:t.url},null,8,["src"])):(c(),n(o,{key:1,class:"van-image"}))])),_:2},1024),r(o,{class:"text"},{default:u((()=>[h(C(t.actionName),1)])),_:2},1024)])),_:2},1032,["class","onClick"]))],64)))),128))])),_:2},1024)])),_:2},1024)))),128)),r(o,{class:"custom-action-button",onClick:l.addActionHandle},{default:u((()=>[r(S,null,{default:u((()=>[h(" + 自定义动作")])),_:1})])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1},8,["class"]),i.showSaveButton?(c(),n(o,{key:0,class:"footer-seat"})):x("",!0),i.showSaveButton?(c(),n(o,{key:1,class:"footer-button"},{default:u((()=>[r(T,{type:"default",onClick:l.goBack},{default:u((()=>[h("取消")])),_:1},8,["onClick"]),r(T,{block:"",type:"primary",onClick:l.goNewWorkout},{default:u((()=>[h("确认添加（"+C(l.selectNum)+"）",1)])),_:1},8,["onClick"])])),_:1})):x("",!0),r(H,{ref:"popup",type:"center","mask-background-color":"rgba(20, 21, 23, 0.6)"},{default:u((()=>[r(o,{class:"dialog"},{default:u((()=>[r(o,{class:"dialog-section"},{default:u((()=>[r(o,{class:"dialog-title"},{default:u((()=>[h("是否确认删除")])),_:1}),r(o,{class:"dialog-content"},{default:u((()=>[h("确认删除该动作吗？删除后无法恢复")])),_:1}),r(o,{class:"dialog-btn-box"},{default:u((()=>[r(T,{type:"default",onClick:l.closePopup},{default:u((()=>[h("取消")])),_:1},8,["onClick"]),r(T,{type:"primary",onClick:l.deleteHandle},{default:u((()=>[h("确认")])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1})])),_:1},512)])),_:1})}],["__scopeId","data-v-e42e7eab"]]);export{S as default};
