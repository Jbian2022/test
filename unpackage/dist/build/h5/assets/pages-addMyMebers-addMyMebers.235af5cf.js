import{j as e,E as t,H as s,m as a,l,o as r,a as n,w as o,i,b as d,f as u,e as m,d as c,t as h,p as g,I as f,v as b,q as y,C as _}from"./index.2d1e5cbb.js";import{_ as p,a as C}from"./uni-forms.5db05612.js";import{r as x}from"./uni-app.es.142f3165.js";import{B as v}from"./bgTheamCompontent.f506f940.js";import{N as F}from"./navBarCompontent.7dcad6b7.js";import{u as w}from"./timeUtil.f179a302.js";import{M as k}from"./mPicker.4fdcbc4b.js";import{_ as S}from"./back.3d645e4a.js";import{_ as N}from"./_plugin-vue_export-helper.cdc0426e.js";import"./uni-transition.c98c413f.js";const M=N({components:{BgTheamCompontent:v,NavBarCompontent:F,Mpicker:k},data:()=>({studentForm:{traineeName:"",gender:"",birthday:"",mobile:"",buyStatus:0},sexShow:!1,birthShow:!1,gender:"",range:[{text:"男",value:"1"},{text:"女",value:"2"}],showPicker:!1,minDate:new Date(1888,1,1),maxDate:new Date(2025,10,1),dateShowpicker:!1,currentDate:new Date,customFieldName:{text:"text",value:"value"},gendDefaultIndex:0,pattern:/^(13[0-9]|14[01456879]|15[0-35-9]|16[2567]|17[0-8]|18[0-9]|19[0-35-9])\d{8}$/,requestItem:null,leftNavTitle:"添加学员",rules:{traineeName:{rules:[{required:!0,errorMessage:"请输入真实姓名"}],label:"真实姓名",validateTrigger:"submit"},gender:{rules:[{required:!0,errorMessage:"请选择性别"}],label:"性别",validateTrigger:"submit"},birthday:{rules:[{required:!0,errorMessage:"请选择生日"}],label:"姓名",validateTrigger:"submit"},mobile:{rules:[{required:!0,errorMessage:"请输入手机号码"},{minLength:11,maxLength:11,errorMessage:"请输入正确的手机号码"}],label:"手机号码",validateTrigger:"submit"}}}),onLoad(e){if("{}"!==JSON.stringify(e)&&e.hasOwnProperty("item")){let t=e.hasOwnProperty("item")?JSON.parse(e.item):null;this.studentForm=this.requestItem=t,this.gender=this.range.find((e=>e.value===t.gender)).text,this.leftNavTitle="基础信息"}},computed:{handleSexDefaultIndex(){let e=0;return e=this.range.findIndex((e=>e.value===this.studentForm.gender)),e},genderLabel(){let e="",t=this.range.find((e=>e.value===this.studentForm.gender));return t&&(e=t.text||""),e}},mounted(){},methods:{openDialog(){this.sexShow=!0},sexConfirm(e){console.log(e,"???"),this.studentForm.gender=-1===e[0]?this.range[0].value:this.range[e[0]].value,this.sexShow=!1},dateConfirm(e){console.log(e,"我是日期"),this.studentForm.birthday=e,this.birthShow=!1},dateCancel(){this.birthShow=!1},sexCancel(){this.sexShow=!1},formatter:(e,t)=>"year"===e?`${t}年`:"month"===e?`${t}月`:"day"===e?`${t}日`:"hour"===e?`${t}时`:"minute"===e?`${t}分`:t,genderChange(e){},birthConfirm(){this.studentForm.birthday=w.timeFormat(this.currentDate,"yyyy-MM-dd"),this.dateShowpicker=!1},genderConfirm(e){this.studentForm.gender=e.value,this.gender=e.text;let t=this.range.findIndex((t=>{t.value=e.value}));this.defaultIndex=t,this.showPicker=!1},addDirectly(r){var n=this;console.log(r,"nishi"),this.$refs.studentForm.validate().then((()=>{try{e("isActive",String(this.studentForm.buyStatus))}catch(i){}let o=t.importObject("businessCloudObject",{customUI:!0});console.log(n.requestItem,"that.requestItem"),"edit"==r||n.requestItem?o.updateMember(n.studentForm).then((e=>{e.success?(s({url:"/pages/myMebers/myMebers",success:e=>{},fail:()=>{},complete:()=>{}}),a({icon:"success",title:res.message,duration:800,width:220})):a({icon:"fail",title:res.message,duration:800,width:220})})).catch((e=>{a({icon:"编辑失败",title:e.message,duration:800,width:220})})):o.addMember(n.studentForm).then((e=>{e.success?(console.log(r,">>>>"),"body"==r?o.getOnlyList({traineeName:n.studentForm.traineeName,mobile:n.studentForm.mobile}).then((e=>{if(console.log(e,"即将发送的res"),e.success){let t=e.data;l({url:"/pages/physicalAssessment/physicalAssessment?traineeNo="+t[0]._id})}})).catch((e=>{})):s({url:"/pages/myMebers/myMebers",success:e=>{},fail:()=>{},complete:()=>{}}),a({icon:"success",title:e.message,duration:800,width:220})):(console.log(2),a({icon:"none",title:e.message,duration:800,width:220}))})).catch((e=>{}))})).catch((e=>{}))},onConfirm(){},onSubmit(){},buyClick(e){this.studentForm.buyStatus=e}}},[["render",function(e,t,s,a,l,v){const F=g("BgTheamCompontent"),w=g("NavBarCompontent"),k=f,N=x(b("uni-forms-item"),p),M=g("Mpicker"),I=i,D=y,T=_,j=x(b("uni-forms"),C);return r(),n(I,{class:"content_style"},{default:o((()=>[d(F,{theamType:"currency"}),d(w,{leftNavTitle:l.leftNavTitle},null,8,["leftNavTitle"]),d(I,{class:"contetnt_form_style"},{default:o((()=>[d(j,{modelValue:l.studentForm,ref:"studentForm",rules:l.rules,"label-position":"top"},{default:o((()=>[d(N,{class:"outer_form_item_style",label:"真实姓名(必填)",name:"traineeName"},{default:o((()=>[d(k,{type:"text",clas:"change_input_style",modelValue:l.studentForm.traineeName,"onUpdate:modelValue":t[0]||(t[0]=e=>l.studentForm.traineeName=e),placeholder:"请输入真实姓名",maxlength:"7",style:{"margin-top":"6px"},"adjust-position":!1},null,8,["modelValue"])])),_:1},8,["label"]),d(N,{class:"outer_form_item_style",label:"性别(必填)",name:"gender"},{default:o((()=>[d(M,{mode:"bottom",show:l.sexShow,range:l.range,rangeKey:"text",onConfirm:v.sexConfirm,onCancel:v.sexCancel,pickerType:"ordinary",defaultIndex:v.handleSexDefaultIndex},null,8,["show","range","onConfirm","onCancel","defaultIndex"]),d(I,{class:"change_picker_style",onClick:u(v.openDialog,["stop"])},{default:o((()=>[d(I,{class:m(["label_style",l.studentForm.gender?"":"student_label_style"])},{default:o((()=>[c(h(l.studentForm.gender?v.genderLabel:"请选择性别"),1)])),_:1},8,["class"]),d(D,{class:"back_img_style",src:S})])),_:1},8,["onClick"])])),_:1},8,["label"]),d(N,{class:"outer_form_item_style",label:"生日(必填)",name:"birthday"},{default:o((()=>[d(M,{mode:"bottom",range:l.range,show:l.birthShow,onConfirm:v.dateConfirm,onCancel:v.dateCancel,pickerType:"date",defaultIndex:0,distinguishModel:l.studentForm.birthday},null,8,["range","show","onConfirm","onCancel","distinguishModel"]),d(I,{class:"change_picker_style",onClick:t[1]||(t[1]=u((e=>l.birthShow=!0),["stop"]))},{default:o((()=>[d(I,{class:m(["label_style",l.studentForm.birthday?"":"student_label_style"])},{default:o((()=>[c(h(l.studentForm.birthday?l.studentForm.birthday:"请选生日"),1)])),_:1},8,["class"]),d(D,{class:"back_img_style",src:S})])),_:1})])),_:1},8,["label"]),d(N,{class:"outer_form_item_style",label:"手机号码(必填)",name:"mobile"},{default:o((()=>[d(k,{type:"number",clas:"change_input_style",style:{"margin-top":"6px"},modelValue:l.studentForm.mobile,"onUpdate:modelValue":t[2]||(t[2]=e=>l.studentForm.mobile=e),placeholder:"请输入手机号码",maxlength:"11","adjust-position":!1},null,8,["modelValue"])])),_:1},8,["label"]),d(I,{class:"is_buy_content_style van-cell"},{default:o((()=>[d(T,{class:"buy_text_style"},{default:o((()=>[c("是否已购课")])),_:1}),d(I,{class:"is_buy_style"},{default:o((()=>[d(I,{class:m(["buy_left",0==l.studentForm.buyStatus?"active":""]),onClick:t[3]||(t[3]=e=>v.buyClick(0))},{default:o((()=>[c("否")])),_:1},8,["class"]),d(I,{class:m(["buy_right",1==l.studentForm.buyStatus?"active":""]),onClick:t[4]||(t[4]=e=>v.buyClick(1))},{default:o((()=>[c("是")])),_:1},8,["class"])])),_:1})])),_:1}),"添加学员"===l.leftNavTitle?(r(),n(I,{key:0,class:"add_method_style"},{default:o((()=>[d(I,{class:"add_left_style",onClick:v.addDirectly},{default:o((()=>[c("直接添加")])),_:1},8,["onClick"]),d(I,{class:"add_right_style",onClick:t[5]||(t[5]=e=>v.addDirectly("body"))},{default:o((()=>[c("身体评测并添加")])),_:1})])),_:1})):(r(),n(I,{key:1,class:"add_method_style edit_save_style",onClick:t[6]||(t[6]=e=>v.addDirectly("edit"))},{default:o((()=>[c(" 保存 ")])),_:1}))])),_:1},8,["modelValue","rules"])])),_:1})])),_:1})}],["__scopeId","data-v-8d445a5a"]]);export{M as default};
