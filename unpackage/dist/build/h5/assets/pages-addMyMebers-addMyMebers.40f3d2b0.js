import{E as e,H as t,m as s,k as a,o as l,a as r,w as i,i as n,b as o,f as d,e as u,d as m,t as c,q as h,I as f,v as b,u as g,C as _}from"./index.3c07bbe7.js";import{_ as y,a as p}from"./uni-forms.92dbc167.js";import{r as v}from"./uni-app.es.2e9f864b.js";import{B as C}from"./bgTheamCompontent.b73a7dbd.js";import{N as x}from"./navBarCompontent.f41d0dd4.js";import{u as w}from"./timeUtil.f179a302.js";import{M as F}from"./mPicker.d4a9f052.js";import{_ as k}from"./back.83fd7f48.js";import{_ as S}from"./_plugin-vue_export-helper.cdc0426e.js";import"./uni-transition.23e18650.js";const N=S({components:{BgTheamCompontent:C,NavBarCompontent:x,Mpicker:F},data:()=>({studentForm:{traineeName:"",gender:"",birthday:"",mobile:"",buyStatus:0},sexShow:!1,birthShow:!1,gender:"",range:[{text:"男",value:"1"},{text:"女",value:"2"}],showPicker:!1,minDate:new Date(1888,1,1),maxDate:new Date(2025,10,1),dateShowpicker:!1,currentDate:new Date,customFieldName:{text:"text",value:"value"},gendDefaultIndex:0,pattern:/^(13[0-9]|14[01456879]|15[0-35-9]|16[2567]|17[0-8]|18[0-9]|19[0-35-9])\d{8}$/,requestItem:null,leftNavTitle:"添加学员",rules:{traineeName:{rules:[{required:!0,errorMessage:"请输入真实姓名"}],label:"真实姓名",validateTrigger:"submit"},gender:{rules:[{required:!0,errorMessage:"请选择性别"}],label:"性别",validateTrigger:"submit"},birthday:{rules:[{required:!0,errorMessage:"请选择生日"}],label:"姓名",validateTrigger:"submit"},mobile:{rules:[{required:!0,errorMessage:"请输入手机号码"},{minLength:11,maxLength:11,errorMessage:"请输入正确的手机号码"}],label:"手机号码",validateTrigger:"submit"}},isActive:""}),onLoad(e){if("{}"!==JSON.stringify(e)&&e.hasOwnProperty("item")){let t=e.hasOwnProperty("item")?JSON.parse(e.item):null;this.studentForm=this.requestItem=t,this.gender=this.range.find((e=>e.value===t.gender)).text,this.leftNavTitle="基础信息"}if("{}"!==JSON.stringify(e)){let t=e.hasOwnProperty("isActive")?e.isActive:"1";this.isActive=t}},computed:{handleSexDefaultIndex(){let e=0;return e=this.range.findIndex((e=>e.value===this.studentForm.gender)),e},genderLabel(){let e="",t=this.range.find((e=>e.value===this.studentForm.gender));return t&&(e=t.text||""),e}},mounted(){},methods:{openDialog(){this.sexShow=!0},sexConfirm(e){console.log(e,"???"),this.studentForm.gender=-1===e[0]?this.range[0].value:this.range[e[0]].value,this.sexShow=!1},dateConfirm(e){console.log(e,"我是日期"),this.studentForm.birthday=e,this.birthShow=!1},dateCancel(){this.birthShow=!1},sexCancel(){this.sexShow=!1},formatter:(e,t)=>"year"===e?`${t}年`:"month"===e?`${t}月`:"day"===e?`${t}日`:"hour"===e?`${t}时`:"minute"===e?`${t}分`:t,genderChange(e){},birthConfirm(){this.studentForm.birthday=w.timeFormat(this.currentDate,"yyyy-MM-dd"),this.dateShowpicker=!1},genderConfirm(e){this.studentForm.gender=e.value,this.gender=e.text;let t=this.range.findIndex((t=>{t.value=e.value}));this.defaultIndex=t,this.showPicker=!1},addDirectly(l){var r=this;console.log(l,"nishi"),this.$refs.studentForm.validate().then((()=>{let i=e.importObject("businessCloudObject");console.log(r.requestItem,"that.requestItem"),"edit"==l||r.requestItem?i.updateMember(r.studentForm).then((e=>{e.success?(t({url:"/pages/myMebers/myMebers?isActive="+this.isActive,success:e=>{},fail:()=>{},complete:()=>{}}),s({icon:"success",title:res.message,duration:800,width:220})):s({icon:"fail",title:res.message,duration:800,width:220})})).catch((e=>{s({icon:"编辑失败",title:e.message,duration:800,width:220})})):i.addMember(r.studentForm).then((e=>{e.success?(console.log(l,">>>>"),"body"==l?i.getOnlyList({traineeName:r.studentForm.traineeName,mobile:r.studentForm.mobile}).then((e=>{if(console.log(e,"即将发送的res"),e.success){let t=e.data;a({url:"/pages/physicalAssessment/physicalAssessment?traineeNo="+t[0]._id})}})).catch((e=>{})):t({url:"/pages/myMebers/myMebers?isActive="+this.isActive,success:e=>{},fail:()=>{},complete:()=>{}}),s({icon:"success",title:e.message,duration:800,width:220})):(console.log(2),s({icon:"none",title:e.message,duration:800,width:220}))})).catch((e=>{}))})).catch((e=>{}))},onConfirm(){},onSubmit(){},buyClick(e){this.studentForm.buyStatus=e}}},[["render",function(e,t,s,a,C,x){const w=h("BgTheamCompontent"),F=h("NavBarCompontent"),S=f,N=v(b("uni-forms-item"),y),M=h("Mpicker"),D=n,I=g,T=_,j=v(b("uni-forms"),p);return l(),r(D,{class:"content_style"},{default:i((()=>[o(w,{theamType:"currency"}),o(F,{leftNavTitle:C.leftNavTitle},null,8,["leftNavTitle"]),o(D,{class:"contetnt_form_style"},{default:i((()=>[o(j,{modelValue:C.studentForm,ref:"studentForm",rules:C.rules,"label-position":"top"},{default:i((()=>[o(N,{class:"outer_form_item_style",label:"真实姓名(必填)",name:"traineeName"},{default:i((()=>[o(S,{type:"text",clas:"change_input_style",modelValue:C.studentForm.traineeName,"onUpdate:modelValue":t[0]||(t[0]=e=>C.studentForm.traineeName=e),placeholder:"请输入真实姓名"},null,8,["modelValue"])])),_:1},8,["label"]),o(N,{class:"outer_form_item_style",label:"性别(必填)",name:"gender"},{default:i((()=>[o(M,{mode:"bottom",show:C.sexShow,range:C.range,rangeKey:"text",onConfirm:x.sexConfirm,onCancel:x.sexCancel,pickerType:"ordinary",defaultIndex:x.handleSexDefaultIndex},null,8,["show","range","onConfirm","onCancel","defaultIndex"]),o(D,{class:"change_picker_style",onClick:d(x.openDialog,["stop"])},{default:i((()=>[o(D,{class:u(["label_style",C.studentForm.gender?"":"student_label_style"])},{default:i((()=>[m(c(C.studentForm.gender?x.genderLabel:"请选择性别"),1)])),_:1},8,["class"]),o(I,{class:"back_img_style",src:k})])),_:1},8,["onClick"])])),_:1},8,["label"]),o(N,{class:"outer_form_item_style",label:"生日(必填)",name:"birthday"},{default:i((()=>[o(M,{mode:"bottom",range:C.range,show:C.birthShow,onConfirm:x.dateConfirm,onCancel:x.dateCancel,pickerType:"date",defaultIndex:0,distinguishModel:C.studentForm.birthday},null,8,["range","show","onConfirm","onCancel","distinguishModel"]),o(D,{class:"change_picker_style",onClick:t[1]||(t[1]=d((e=>C.birthShow=!0),["stop"]))},{default:i((()=>[o(D,{class:u(["label_style",C.studentForm.birthday?"":"student_label_style"])},{default:i((()=>[m(c(C.studentForm.birthday?C.studentForm.birthday:"请选生日"),1)])),_:1},8,["class"]),o(I,{class:"back_img_style",src:k})])),_:1})])),_:1},8,["label"]),o(N,{class:"outer_form_item_style",label:"手机号码(必填)",name:"mobile"},{default:i((()=>[o(S,{type:"number",clas:"change_input_style",modelValue:C.studentForm.mobile,"onUpdate:modelValue":t[2]||(t[2]=e=>C.studentForm.mobile=e),placeholder:"请输入手机号码",maxlength:"11"},null,8,["modelValue"])])),_:1},8,["label"]),o(D,{class:"is_buy_content_style van-cell"},{default:i((()=>[o(T,{class:"buy_text_style"},{default:i((()=>[m("是否已购课")])),_:1}),o(D,{class:"is_buy_style"},{default:i((()=>[o(D,{class:u(["buy_left",0==C.studentForm.buyStatus?"active":""]),onClick:t[3]||(t[3]=e=>x.buyClick(0))},{default:i((()=>[m("否")])),_:1},8,["class"]),o(D,{class:u(["buy_right",1==C.studentForm.buyStatus?"active":""]),onClick:t[4]||(t[4]=e=>x.buyClick(1))},{default:i((()=>[m("是")])),_:1},8,["class"])])),_:1})])),_:1}),"添加学员"===C.leftNavTitle?(l(),r(D,{key:0,class:"add_method_style"},{default:i((()=>[o(D,{class:"add_left_style",onClick:x.addDirectly},{default:i((()=>[m("直接添加")])),_:1},8,["onClick"]),o(D,{class:"add_right_style",onClick:t[5]||(t[5]=e=>x.addDirectly("body"))},{default:i((()=>[m("身体评测并添加")])),_:1})])),_:1})):(l(),r(D,{key:1,class:"add_method_style edit_save_style",onClick:t[6]||(t[6]=e=>x.addDirectly("edit"))},{default:i((()=>[m(" 保存 ")])),_:1}))])),_:1},8,["modelValue","rules"])])),_:1})])),_:1})}],["__scopeId","data-v-48d0620f"]]);export{N as default};
