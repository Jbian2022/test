import{c as e,o as t,a as s,w as i,b as o,r as a,n as l,d as r,e as c,f as n,i as p,s as d,g as m,h as u,j as h,E as f,k as b,l as g,m as _,t as y,p as v,q as k,M as x,u as M,v as L}from"./index.2d1e5cbb.js";import{_ as w}from"./uni-popup.2df5a944.js";import{r as C}from"./uni-app.es.142f3165.js";import{B as $}from"./bgTheamCompontent.f506f940.js";import{M as I}from"./memberList.b508e6f5.js";import{_ as T}from"./_plugin-vue_export-helper.cdc0426e.js";import{h as O}from"./moment.9868ad4b.js";import"./uni-transition.c98c413f.js";const j={props:{visible:Boolean,color:{type:String,default:"#303133"},placement:{type:String,default:"top"},content:{type:String,default:""},show:{type:Boolean,default:!1}},data(){return{isShow:this.visible,title:"Hello",arrowLeft:0,query:null,style:{},arrowStyle:{}}},onLoad(){},watch:{isShow:{handler(e){this.$emit("update:visible",e)},immediate:!0},visible:{handler(e){this.isShow=e,e&&this.$nextTick((()=>{this.handleClick()}))},immediate:!0}},mounted(){window.addEventListener("click",(()=>{this.isShow=!1}))},methods:{close(){this.isShow=!1},fixedWrap(){this.isShow=!1},handleClick(){e().in(this).selectAll(".zb_tooltip_content,.zb_tooltip__popper").boundingClientRect((async e=>{let{left:t,bottom:s,right:i,top:o,width:a,height:l}=e[0],r=e[1],c={},n={};switch(this.placement){case"top":r.width>a?c.left=`-${(r.width-a)/2}px`:c.left=Math.abs(r.width-a)/2+"px",c.bottom=`${l+8}px`,n.left=r.width/2-6+"px";break;case"top-start":c.left="0px",c.bottom=`${l+8}px`;break;case"top-end":c.right="0px",c.bottom=`${l+8}px`,n.right="8px";break;case"bottom":r.width>a?c.left=`-${(r.width-a)/2}px`:c.left=Math.abs(r.width-a)/2+"px",c.top=`${l+8}px`,n.left=r.width/2-6+"px";break;case"bottom-start":c.left="0px",c.top=`${l+8}px`,n.left="8px";break;case"bottom-end":c.right="0px",c.top=`${l+8}px`,n.right="8px";break;case"right":c.left=`${a+8}px`,r.height>l?c.top=`-${(r.height-l)/2}px`:c.top=`${Math.abs((r.height-l)/2)}px`,n.top=r.height/2-6+"px";break;case"right-start":c.left=`${a+8}px`,c.top="0px",n.top="8px";break;case"right-end":c.left=`${a+8}px`,c.bottom="0px",n.bottom="8px";break;case"left":c.right=`${a+8}px`,r.height>l?c.top=`-${(r.height-l)/2}px`:c.top=`${Math.abs((r.height-l)/2)}px`,n.top=r.height/2-6+"px";break;case"left-start":c.right=`${a+8}px`,c.top="0px",n.top="8px";break;case"left-end":c.right=`${a+8}px`,c.bottom="0px",n.bottom="8px"}this.style=c,this.arrowStyle=n,this.isShow=!0})).exec()}}};const A=T({components:{BgTheamCompontent:$,MemberList:I,ZbTooltip:T(j,[["render",function(e,d,m,u,h,f){const b=p;return t(),s(b,{class:"zb-tooltip",style:l({"--theme-bg-color":m.color})},{default:i((()=>[o(b,{class:"zb_tooltip_content",onClick:n(f.handleClick,["stop"])},{default:i((()=>[a(e.$slots,"default",{},void 0,!0),o(b,{class:"zb_tooltip__popper",style:l([h.style,{visibility:h.isShow?"visible":"hidden",color:"white"===m.color?"":"#fff"}])},{default:i((()=>[a(e.$slots,"content",{},(()=>[o(b,{class:"remark"},{default:i((()=>[r("Hi~教练你来了")])),_:1}),o(b,{class:"remark"},{default:i((()=>[r("点这里添加会员吧")])),_:1})]),!0),o(b,{class:c(["zb_popper__icon",[{zb_popper__up:0===m.placement.indexOf("bottom"),zb_popper__arrow:0===m.placement.indexOf("top"),zb_popper__right:0===m.placement.indexOf("right"),zb_popper__left:0===m.placement.indexOf("left")}]]),style:l([h.arrowStyle])},null,8,["style","class"])])),_:3},8,["style"])])),_:3},8,["onClick"])])),_:3},8,["style"])}],["__scopeId","data-v-38cd6c04"]])},data:()=>({meberList:[],isActive:1,deleteRemarkFlag:!1,loginNum:0,showPopover:!1,scrollTop:0,searchTopFlag:!1,buyTopFlag:!1,delteIndex:0,avatar:null,addUpperLimit:null,cocahMemberLimit:0,page:10,currentNum:1,termOfValidity:!1,userInfo:{}}),onLoad(){d()},created(){this.getUserInfor()},mounted(){let e=this;this.$nextTick((()=>{m({key:"loginNum",success:function(t){t.data&&(e.loginNum=t.data,e.showPopover="0"==t.data,"0"==t.data&&e.$refs.popup.open())},fail:function(e){console.log(e,">>>>")}});try{if(-1!==u().keys.indexOf("isActive"))m({key:"isActive",success:function(t){t.data&&(e.isActive=Number(t.data),e.$refs.memberListDom.getMemberList(Number(t.data)))},fail:function(e){}});else try{h("isActive","1"),e.isActive=1,e.$refs.memberListDom.getMemberList(1)}catch(t){}}catch(t){}})),this.getCocachList()},onShow(){this.getUserInfor()},methods:{getUserInfor(){const e=f.importObject("login",{customUI:!0});let t=this;try{e.getUserInfoMessage().then((e=>{console.log(e,"...."),t.avatar=e.userInfo.avatar||null,t.addUpperLimit=e.userInfo.addUpperLimit||null,t.userInfo=e.userInfo||{};let s=O().format("YYYY-MM-DD");if(e.userInfo.vipEndDate||e.userInfo.vipLevel){let i=O(s).isSame(e.userInfo.vipEndDate);console.log("补药"),t.termOfValidity=!i&&O(s).isBefore(e.userInfo.vipEndDate)}else t.termOfValidity=!1})).catch((e=>{}))}catch(s){}},getCocachList(){f.importObject("businessCloudObject",{customUI:!0}).getCoachMemberList().then((e=>{console.log(e,"腻"),this.cocahMemberLimit=e.affectedDocs})).catch((e=>{}))},getMemberList(e){this.meberList=e},onClickPopMenu(e){this.showMenuPop=!1},jumpQuery(){console.log(111),b({key:"isActive",success:function(e){console.log("success")}}),g({url:"/pages/memberQuery/memberQuery",success:e=>{},fail:()=>{},complete:()=>{}})},upper:function(e){console.log(e,"mmm")},lower:function(e){console.log(e)},scroll(e){console.log(e.detail.scrollTop,"我是距离"),this.scrollTop=e.detail.scrollTop,e.detail.scrollTop>50?this.searchTopFlag=!0:this.searchTopFlag=!1,e.detail.scrollTop>95?this.buyTopFlag=!0:this.buyTopFlag=!1},maskClick(){h("loginNum","1"),this.$refs.popup.close(),this.showPopover=!1},addClick(){let e=f.importObject("businessCloudObject",{customUI:!0}),t=this;e.getCoachMemberList().then((e=>{if(console.log(t.termOfValidity,t.userInfo,"你都是咖啡可考虑"),t.cocahMemberLimit=e.affectedDocs,!t.termOfValidity||!t.userInfo.vipLevel)return!t.addUpperLimit&&t.cocahMemberLimit>=7?void _({title:"普通教练限添加7名学员,升级金卡教练获取更多权益~",duration:1e3,width:180,icon:"none"}):void((t.addUpperLimit||t.cocahMemberLimit<7)&&g({url:"/pages/addMyMebers/addMyMebers",success:e=>{},fail:()=>{},complete:()=>{}}));if(t.termOfValidity&&t.userInfo.vipLevel)switch(t.userInfo.vipLevel){case"annualCard":g({url:"/pages/addMyMebers/addMyMebers",success:e=>{},fail:()=>{},complete:()=>{}});break;case"quarterCard":if(!t.addUpperLimit&&t.cocahMemberLimit>=100)return void _({title:"月卡教练限制添加30个会员，升级年卡可无限添加会员哦~",duration:1e3,width:180,icon:"none"});(t.addUpperLimit||t.cocahMemberLimit<100)&&g({url:"/pages/addMyMebers/addMyMebers",success:e=>{},fail:()=>{},complete:()=>{}});break;case"monthlyCard":if(!t.addUpperLimit&&t.cocahMemberLimit>=30)return void _({title:"月卡教练限制添加30个会员，升级年卡可无限添加会员哦~",duration:1e3,width:180,icon:"none"});(t.addUpperLimit||t.cocahMemberLimit<30)&&g({url:"/pages/addMyMebers/addMyMebers",success:e=>{},fail:()=>{},complete:()=>{}})}})).catch((e=>{}))},buyClick(e){this.$nextTick((function(){try{h("isActive",String(e))}catch(t){}this.isActive=e,this.$refs.memberListDom.getMemberList(e)}))}}},[["render",function(e,a,l,d,m,u){const h=v("BgTheamCompontent"),f=k,b=p,g=v("MemberList"),_=v("ZbTooltip"),$=x,I=M,T=C(L("uni-popup"),w);return t(),s(b,{class:"move_area_style"},{default:i((()=>[o(I,null,{default:i((()=>[o(b,{class:"content_style"},{default:i((()=>[o(h,{theamType:"currency"}),o(b,{class:"header_style"},{default:i((()=>[o(b,{class:"header_left_style"},{default:i((()=>[o(b,{class:"left_content_style"},{default:i((()=>[m.avatar?(t(),s(f,{key:0,class:"left_content_img_style",src:m.avatar},null,8,["src"])):(t(),s(f,{key:1,class:"left_content_img_style",src:"/assets/defaultAvator.1d6a27fc.png"})),o(b,{class:"left_header_style"},{default:i((()=>[r("我的会员")])),_:1}),o(b,{class:"left_num_style"},{default:i((()=>[r(y(m.meberList.length),1)])),_:1})])),_:1})])),_:1}),o(b,{class:"header_right_style"},{default:i((()=>[o(f,{class:"right_img_style",src:"/assets/fangdajing.f4179530.svg",onClick:u.jumpQuery},null,8,["onClick"])])),_:1})])),_:1}),o(b,{class:"is_buy_style"},{default:i((()=>[o(b,{class:c(["buy_left",1===m.isActive?"active":""]),onClick:a[0]||(a[0]=n((e=>u.buyClick(1)),["stop"]))},{default:i((()=>[r("已购课")])),_:1},8,["class"]),o(b,{class:c(["buy_right",0===m.isActive?"active":""]),onClick:a[1]||(a[1]=e=>u.buyClick(0))},{default:i((()=>[r("未购课")])),_:1},8,["class"])])),_:1}),o(b,{class:"member_scroll_style"},{default:i((()=>[o(g,{ref:"memberListDom",isActive:m.isActive,type:"home",page:m.page,currentNum:m.currentNum,onGetMemberList:u.getMemberList,userInfo:m.userInfo,termOfValidity:m.termOfValidity},null,8,["isActive","page","currentNum","onGetMemberList","userInfo","termOfValidity"])])),_:1})])),_:1}),o($,{direction:"all",inertia:""},{default:i((()=>[o(b,{class:c(["btn_add",0==m.loginNum?"guid_style":""])},{default:i((()=>[o(b,{class:"add_style"},{default:i((()=>[o(f,{class:"add_img_style",src:"/assets/add.f144635d.svg",onClick:n(u.addClick,["stop"])},null,8,["onClick"]),o(b,null,{default:i((()=>[o(_,{visible:m.showPopover,placement:"left",color:"linear-gradient(180deg, #2BA9FF 0%, #1370FF 100%)",content:"Hi～教练你来了\r\n\t\t\t  点这里添加会员吧",show:!0},null,8,["visible","color"])])),_:1})])),_:1})])),_:1},8,["class"])])),_:1})])),_:1}),o(T,{ref:"popup",type:"center","mask-background-color":"rgba(20, 21, 23, 0.6)",class:"new_popup_style_outer_style",onMaskClick:u.maskClick},null,8,["onMaskClick"])])),_:1})}],["__scopeId","data-v-72d9708b"]]);export{A as default};
